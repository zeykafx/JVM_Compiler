
Type -> BaseType IsList .
BaseType -> record | NumType | bool | string .
NumType -> int | float .
IsList -> "[]" | .

Block -> "{" Stmts "}" .
Stmts ->   | Stmt Stmts .
Stmt -> "return" ReturnStmt";" | IfStmt | ForLoop | WhileLoop | FunctionDefinition";" | BaseStatement";" .
ReturnStmt ->  IdentifierAccess | VariableCreation | VariableAssignment | RecordDefinition .

BaseStatement -> VariableCreation | VariableAssignment | RecordDefinition .

VariableCreation -> Final identifier Type Assignment .
Assignment ->  | "=" Expression .
Final ->  | "final" .

VariableAssignment -> IdentifierAccess "=" Expression | IdentifierAccess "=" IdentifierAccess .

RecordDefinition -> recordNameIdentifier rec "{" RecordFields "}" .
RecordFields -> RecordField ";" MoreRecordFields  .
MoreRecordFields ->  | RecordField MoreRecordFields .
RecordField -> identifier Type ";" .

FunctionDefinition -> fun identifier "(" Params ")" Type .

Params ->  | Param MoreParams .
MoreParams ->  |"," Param MoreParams .
Param -> Type identifier .

FunctionCall -> identifier "(" ParamsCall ")" .
ParamsCall ->  | FunctionCall MoreParamsCall | Expression MoreParamsCall .
MoreParamsCall ->  | "," ParamsCall .


IfStmt -> "if" "(" Expression ")" Block ElseStmt .
ElseStmt ->  | "else" Block .

WhileLoop -> while "(" Expression ")" Block .
ForLoop -> for "(" ForCondition ")" Block .
ForCondition -> identifier "," NumType "," NumType "," NumType .

-> identifier Access .
Access -> "[" ArrayAccess | "." RecordAccess | .

ArrayAccess -> Expression "]" .


ArrayAccess -> identifier "[" Expression "]" | RecordAccess "[" Expression "]" .
RecordAccess -> identifier "." Expression | ArrayAccess "." Expression .
IdentifierAccess -> identifier | ArrayAccess | RecordAccess .

Expression -> TypeValue | IdentifierAccess .


-------------
Type -> BaseType IsList .
BaseType -> record | NumType | bool | string .
NumType -> int | float .
IsList -> "[]" | .

Block -> "{" Stmts "}" .
Stmts ->   | Stmt Stmts .
Stmt -> "return" ReturnStmt";" | IfStmt | ForLoop | WhileLoop | FunctionDefinition";" | BaseStatement";" .
ReturnStmt ->  IdentifierAccess | VariableCreation | VariableAssignment | RecordDefinition .

BaseStatement -> VariableCreation | VariableAssignment | RecordDefinition .

VariableCreation -> Final identifier Type Assignment .
Assignment ->  | "=" Expression .
Final ->  | "final" .

VariableAssignment -> IdentifierAccess "=" Expression | IdentifierAccess "=" IdentifierAccess .

RecordDefinition -> recordNameIdentifier rec "{" RecordFields "}" .
RecordFields -> RecordField ";" MoreRecordFields  .
MoreRecordFields ->  | RecordField MoreRecordFields .
RecordField -> identifier Type ";" .

FunctionDefinition -> fun identifier "(" Params ")" Type .

Params ->  | Param MoreParams .
MoreParams ->  |"," Param MoreParams .
Param -> Type identifier .

FunctionCall -> identifier "(" ParamsCall ")" .
ParamsCall ->  | FunctionCall MoreParamsCall | Expression MoreParamsCall .
MoreParamsCall ->  | "," ParamsCall .


IfStmt -> "if" "(" Expression ")" Block ElseStmt .
ElseStmt ->  | "else" Block .

WhileLoop -> while "(" Expression ")" Block .
ForLoop -> for "(" ForCondition ")" Block .
ForCondition -> identifier "," NumType "," NumType "," NumType .

IdentifierAccess -> "identifier" IdentifierAccessTail .
IdentifierAccessTail -> "[" Expression "]" IdentifierAccessTail | "." Expression IdentifierAccessTail |  .

ArrayAccess -> identifier "[" Expression "]" | RecordAccess "[" Expression "]" .
RecordAccess -> identifier "." Expression | ArrayAccess "." Expression .
IdentifierAccess -> identifier | ArrayAccess | RecordAccess .

Expression -> TypeValue | IdentifierAccess .


----- Better grammar:
Program -> Declarations RecordDefinitions FunctionDefinitions .

Type -> BaseType IsList .
BaseType -> "record" | NumType | "bool" | "string" .
NumType -> "int" | "float" .
IsList -> "[]" | .

Block -> "{" Stmts ReturnStmt "}" .
Stmts -> Stmt Stmts | .
Stmt -> IfStmt | ForLoop | WhileLoop | FunctionDefinition | BaseStatement ";" .
ReturnStmt -> "return" Expression ";" | .

BaseStatement -> Declaration | VariableAssignment | RecordDefinition .

Declarations -> Declaration Declarations | .

Declaration -> Final "identifier" Type Assignment . # (need to add "var" to be LL(1))
Assignment -> "=" Expression | .
Final -> "final" | .

VariableAssignment -> IdentifierAccess "=" Expression .

RecordDefinitions -> RecordDefinition RecordDefinitions | .

RecordDefinition -> "recordNameIdentifier" "rec" "{" RecordFields "}" .
RecordFields -> RecordField RecordFieldsTail | .
RecordFieldsTail -> ";" RecordField RecordFieldsTail | .
RecordField -> "identifier" Type .

FunctionDefinitions -> FunctionDefinition FunctionDefinitions | .
FunctionDefinition -> "fun" "identifier" "(" Params ")" Type Block .

Params -> Param ParamsTail | .
ParamsTail -> "," Param ParamsTail | .
Param -> "identifier" Type .


IfStmt -> "if" "(" Expression ")" Block ElseStmt .
ElseStmt -> "else" Block | .

WhileLoop -> "while" "(" Expression ")" Block .
ForLoop -> "for" "(" ForCondition ")" Block .
ForCondition -> "identifier" "," NumType "," NumType "," NumType .


IdentifierAccess -> "identifier" AccessChain .
AccessChain -> Access AccessChain | .
Access -> "[" Expression "]" | "." "identifier" .

FunctionCall -> "identifier" "(" ParamsCall ")" . # NOT LL(1)
ParamsCall -> Expression MoreParamsCall .
MoreParamsCall ->  | "," ParamsCall .

Expression -> Term IsBinaryExpr | ArrayExpression | UnaryOperator Term .
IsBinaryExpr -> BinaryOperator Term | .

ArrayExpression -> "array" "[" "intval" "]" "of" Type ";" .

NewRecord -> "recordNameIdentifier" "(" ParamsCall ")" . # Note: record identifiers start with a capital letter

Term -> "(" Expression ")" | IdentifierOrFunctionCall | NewRecord | ConstVal .
IdentifierOrFunctionCall -> "identifier" IdentifierOrFunctionCallTail .
IdentifierOrFunctionCallTail -> | "(" ParamsCall ")" .

Term -> "(" Expression ")" | IdentifierAccess | FunctionCall | "!" Term | ConstVal .
Operator -> "||" | "&&" | "==" | "!=" | "<" | ">" | "<=" | ">=" | "+" | "-" | "*" | "/" | "%" .
ConstVal -> "intval" | "floatval" | "boolval" | "stringval" | "true" | "false" .
